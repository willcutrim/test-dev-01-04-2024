{% extends "base.html" %}

{% block title%} Listagem de Consummers {% endblock %}
{% block content %}
    <h1>Economia de Energia</h1>

    <!-- Filter selectors -->
    <label for="consumer-type">Tipo de Consumidor:</label>
    <select id="consumer-type" onchange="filterRows()">
        <option value="all">Todos</option>
        <option value="residential">Residencial</option>
        <option value="commercial">Comercial</option>
        <option value="industrial">Industrial</option>
    </select>

    <label for="consumption-range">Faixa de Consumo:</label>
    <select id="consumption-range" onchange="filterRows()">
        <option value="all">Todos</option>
        <option value="low">Baixo (&lt; 10.000 kWh)</option>
        <option value="medium">MÃ©dio (10.000 - 20.000 kWh)</option>
        <option value="high">Alto (&gt; 20.000 kWh)</option>
    </select>
    
    <!-- Table to display data -->
    <table>
        <thead>
            <tr>
                <th>Nome</th>
                <th>Documento</th>
                <th>Consumo</th>
                <th>Tipo</th>
                <th>Cobertura</th>
                <th>Desconto</th>
                <th>Economia</th>
            </tr>
        </thead>
        <tbody>
            {% for i in regras %}
            <!-- Sample data rows, replace with actual data from backend -->
            <tr class="data-row" data-type="residential" data-range="low">
                <td>{{i.name}}</td>
                <td>{{i.document}}</td>
                <td>{{i.discount_rule.consumption_range}}</td>
                <td>{{i.discount_rule.consumer_type}}</td>
                <td>{{i.discount_rule.cover_value}}%</td>
                <td>{{i.discount_rule.discount_value}}</td>
                <td>{{i.discount_rule.calculate_savings}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>


    <script>
        // JavaScript function to filter rows based on consumer type and consumption range
        function filterRows() {
            var consumerType = document.getElementById("consumer-type").value;
            var consumptionRange = document.getElementById("consumption-range").value;
            var rows = document.getElementsByClassName("data-row");

            for (var i = 0; i < rows.length; i++) {
                var row = rows[i];
                var typeMatch = consumerType === "all" || row.getAttribute("data-type") === consumerType;
                var rangeMatch = consumptionRange === "all" || row.getAttribute("data-range") === consumptionRange;
                if (typeMatch && rangeMatch) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            }
        }
    </script>

{% endblock %}